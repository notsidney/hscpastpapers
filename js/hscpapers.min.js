function urlParam(e){var o=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null===o?"":decodeURIComponent(o[1])}function urlNotFound(e){function o(e,o,a){a?r.append('<tr class="error"><td>'+e+"</td><td>"+o+"</td></tr>"):r.append("<tr><td>"+e+"</td><td>"+o+"</td></tr>")}var r=$("#not-found-modal-table"),a=$("#not-found-modal-type");switch(r.html(""),a.html(""),a.html(e),e){case"Course":o("Course",urlCourse,!0);break;case"Year":o("Course",urlCourse,!1),o("Year",urlYear,!0);break;case"Doc":o("Course",urlCourse,!1),o("Year",urlYear,!1),o("Doc",urlDoc,!0);case"Course2":o("Course2",urlCourse2,!0);break;case"Year2":o("Course2",urlCourse2,!1),o("Year2",urlYear2,!0);break;case"Doc2":o("Course2",urlCourse2,!1),o("Year2",urlYear2,!1),o("Doc2",urlDoc2,!0)}$("#not-found-modal").modal({duration:200,onApprove:function(){urlCourse="",urlYear="",urlDoc="",setTimeout(function(){$("#"+e.toLowerCase()+"-dropdown").dropdown("show")},200)}}).modal("show")}function populateDropdown(e,o,r,a){var t=[];for(i=0;i<e.length;i++)t.push(e[i][o]);for(t.sort(),a&&t.reverse(),$(r).empty(),j=0;j<t.length;j++)$(r).append('<div class="item" data-value"1">'+t[j]+"</div>")}function timerIncrement(){(idleTime+=5)>=5&&!0===dimmable&&$("body").addClass("idle")}function resetTimer(){idleTime=-5,$("body").removeClass("idle")}function updateTabTitle(){"Document"!=$("#doc-dropdown .text.overflow").html()?(document.title=$("#year-dropdown .text").html()+" "+$("#course-dropdown .text").html()+" "+$("#doc-dropdown .text.overflow").html(),$("body").hasClass("split")&&"Document"!=$("#doc-dropdown2 .text.overflow").html()&&(document.title+=" | "+$("#year-dropdown2 .text").html()+" "+$("#course-dropdown2 .text").html()+" "+$("#doc-dropdown2 .text.overflow").html())):document.title="HSC Past Papers"}var jsonData,courseIndex,yearIndex,docLink,urlCourse,urlYear,urlDoc,urlCourse2,urlYear2,urlDoc2,selectedCourse,selectedYear,selectedDoc,params,version,timestamp;$(document).ready(function(){$("#nojquery").hide(),urlCourse=urlParam("course"),urlYear=urlParam("year"),urlDoc=urlParam("doc"),urlCourse2=urlParam("course2"),urlYear2=urlParam("year2"),urlDoc2=urlParam("doc2"),"about"==urlParam("open")&&$("#about-modal").modal("show"),params={mode:"normal"},$("#more-dropdown").dropdown({action:"nothing"}),$.getJSON("data/data.json",function(e){populateDropdown(jsonData=e,"course_name","#course-menu",!1),populateDropdown(jsonData,"course_name","#course-menu2",!1),$("#loader").removeClass("active"),$("#loadingmsg").hide(),$("#course-dropdown").removeClass("disabled").dropdown("show").dropdown({selectOnKeydown:!1}),$("#course-dropdown2").removeClass("disabled").dropdown({selectOnKeydown:!1}),urlCourse&&($("#course-dropdown").dropdown("set selected",urlCourse).dropdown("hide"),$("#course-dropdown").dropdown("get value")||urlNotFound("Course")),urlCourse2&&($("#course-dropdown2").dropdown("set selected",urlCourse2).dropdown("hide"),$("#course-dropdown2").dropdown("get value")||urlNotFound("Course2"))}),$.getJSON("version.json",function(e){version=e.version,$("#version").html(e.version),$(".button-about").popup({title:"Version "+e.version})}),$.getJSON("data/meta.json",function(e){timestamp=new Date(e.timestamp),$("#timestamp").html(timestamp.toLocaleDateString()).popup({html:timestamp.toLocaleTimeString()+"<br>Sydney time"}),$(".button-about").popup({title:"Version "+version,content:"Data updated "+timestamp.toLocaleDateString()})}),$(".popup").popup(),$("#about-modal").modal({duration:200})}),$("#course-input").change(function(){for(selectedCourse=$("#course-input")[0].value,params.course=selectedCourse,$("#year-dropdown").addClass("loading").removeClass("disabled"),k=0;k<jsonData.length;k++)if(jsonData[k].course_name.toLowerCase()==selectedCourse){courseIndex=k;break}populateDropdown(jsonData[courseIndex].packs,"year","#year-menu",!0),$("#year-dropdown").removeClass("loading").dropdown("restore defaults").dropdown("show").dropdown({selectOnKeydown:!1}),urlYear&&($("#year-dropdown").dropdown("set selected",urlYear).dropdown("hide"),$("#year-dropdown").dropdown("get value")||urlNotFound("Year")),history.pushState(null,"","?"+$.param(params))}),$("#year-input").change(function(){if(""!=$(this)[0].value){for(selectedYear=$("#year-input")[0].value,params.year=selectedYear,$("#doc-dropdown").addClass("loading").removeClass("disabled"),l=0;l<jsonData[courseIndex].packs.length;l++)if(jsonData[courseIndex].packs[l].year==selectedYear){yearIndex=l;break}populateDropdown(jsonData[courseIndex].packs[yearIndex].docs,"doc_name","#doc-menu",!1),$("#doc-dropdown").removeClass("loading").dropdown("restore defaults").dropdown("show"),urlDoc&&($("#doc-dropdown").dropdown("set selected",urlDoc).dropdown("hide"),$("#doc-dropdown").dropdown("get value")||urlNotFound("Doc")),$(".button-exampack").removeClass("disabled").attr("href",jsonData[courseIndex].packs[yearIndex].link),history.pushState(null,"","?"+$.param(params))}}),$("#doc-input").change(function(){if(""!=$(this)[0].value){for(selectedDoc=$("#doc-input")[0].value,params.doc=selectedDoc,m=0;m<jsonData[courseIndex].packs[yearIndex].docs.length;m++)if(jsonData[courseIndex].packs[yearIndex].docs[m].doc_name.toLowerCase()==selectedDoc){docLink=jsonData[courseIndex].packs[yearIndex].docs[m].doc_link,docLink=docLink.replace("http","https");break}$("#iframe").attr("src",docLink),$("#loader").addClass("active"),$(".button-download").removeClass("disabled").attr("href",docLink),$(".button-link").removeClass("disabled").removeAttr("disabled"),$("#pdf-dropdown").removeClass("disabled").dropdown({action:"nothing"}),history.pushState(null,"","?"+$.param(params)),updateTabTitle(),dimmable=!0}}),$(".button-link").click(function(){prompt("Copy link below:",docLink)}),$(".button-about").click(function(){$("#about-modal").modal("show")}),$("#close-modal").click(function(){"about"==urlParam("open")&&history.pushState(null,"","?")}),$("#iframe").on("load",function(){$("#loader").removeClass("active")});var idleTime=0,dimmable=!1;$(document).ready(function(){setInterval(timerIncrement,5e3);$(this).mousemove(function(e){resetTimer()}),$(this).mousedown(function(e){resetTimer()}),$(this).mouseup(function(e){resetTimer()}),$(this).keypress(function(e){resetTimer()})});